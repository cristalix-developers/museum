apply plugin: 'java'

subprojects {
    apply plugin: 'java'

    targetCompatibility = sourceCompatibility = '1.8'

    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url "https://repo.implario.dev/public"
        }
    }

    compileJava.options.encoding 'UTF-8'

    tasks.withType(JavaCompile) {
        options.encoding 'UTF-8'
    }

    dependencies {
        annotationProcessor 'org.projectlombok:lombok:1.18.12'
        compileOnly 'org.projectlombok:lombok:1.18.12'
        compileOnly 'io.netty:netty-all:4.1.50.Final'
        compileOnly 'com.google.guava:guava:29.0-jre'
        implementation 'com.google.code.gson:gson:2.8.6'
        implementation 'clepto:clepto-java:0.3.9'
    }

    jar {
        from sourceSets.main.resources
        from {
            duplicatesStrategy = DuplicatesStrategy.EXCLUDE
            configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
        }
    }

    task deploy(type: Copy) {
        dependsOn build
        from jar
        into rootProject.buildDir
    }

}


